一张地图（按子系统）3
入口 / 生命周期

src/main.ts：插件入口；读写持久化、清理旧配置、初始化 DataStore、注册代码块渲染、监听 Vault、注入样式、设置页与三种“快速录入”命令。

配置 / 类型

config/schema.ts：核心数据模型 Item、仪表盘配置 DashboardConfig/ModuleConfig、过滤/排序规则与工具函数。

config/constants.ts：常量（代码块语言、操作符、表情、样式 ID、默认 CSS）。

config/categoryColorMap.ts：类别→颜色映射。

核心逻辑2

core/CodeblockEmbedder.ts：处理 ```think 代码块，解析内联/命名仪表盘并挂载 Dashboard。

core/VaultWatcher.ts：监听 md 文件增删改名→触发数据重扫与视图刷新。

数据层

data/store.ts：单例数据仓库；扫描所有 md、解析为 Item、索引、查询、订阅变更、调用 TaskService 完成任务。

data/parser.ts：把任务行/块区段解析为 Item（标签、KV、日期、优先级、图标等）。

data/mark.ts：完成任务与周期任务（🔁 every …）的解析与下一条生成。

业务服务

services/taskService.ts：将某一任务标记为完成（写回文件、插入下一条、重扫并通知刷新）。

services/inputService.ts：把“快速录入”的任务/块写入到按主题规则选择/创建的目标文件。

视图层（Dashboard → Module → 各视图）

views/Dashboard.tsx：顶层容器；处理“年/季/月/周/天”时间窗口、关键字过滤、按 path/tags 限定、渲染各模块。

views/ModulePanel.tsx：可折叠模块（支持 Ctrl/⌘ + 点击全折叠/展开）。

views/index.ts：视图注册表。

可用视图：

views/BlockView.tsx：任务/块混合列表（含“完成”复选框）。

views/TableView.tsx：二维表按行/列字段聚合（含“完成”复选框）。

views/ExcelView.tsx：通用表格（显示选择字段或全部字段）。

views/common/TaskCheckbox.tsx：统一复选框组件。

占位视图：CalendarView.tsx、TimelineView.tsx、ChartView.tsx（尚未实现）。

设置 / 管理 UI

ui/SettingsTab.ts：设置页。上半是“通用输入设置”表格；下半是仪表盘管理（创建/编辑/删除）。

ui/InputSettingsTable.tsx：极简表格（单击单元格弹 JSON 编辑；主题增删；图标编辑）。

ui/DashboardConfigForm.tsx：MUI 表单编辑仪表盘；字段/分组/过滤/排序/视图选择。

ui/mui-theme.ts：统一 MUI 主题。

快速录入弹窗：

ui/modals/QuickTaskModal.tsx：任务（📅/🛫/✅、时间、时长、重复、主题）。

ui/modals/QuickBlockModal.tsx：计划/总结/思考（日期、主题、可选字段）。

ui/modals/QuickHabitModal.tsx：打卡（预设、评分、主题、备注）。

工具

utils/date.ts：日期规范化与时间窗口（年/季/月/周/天）。

utils/itemFilter.ts：通用的筛选/排序/日期区间/关键字过滤。

utils/regex.ts：常用正则（日期、标签、任务前缀等）。

utils/templates.ts：生成任务行与块文本（与 parser 对齐）。

utils/text.ts：清理任务标题的通用函数。

utils/timing.ts：throttle。

utils/obsidian.ts：构造 obsidian:// 链接。

utils/inputSettings.ts：从插件实例拿统一输入设置。

样式

views/styles.css：复选框用系统样式，已完成不可再次点击等。

主线数据流（你看这个就能“脑补”运行方式）
加载：main.ts → 读持久化、初始化 DataStore.scanAll()、注册 VaultWatcher/CodeblockEmbedder、设置页、快速录入命令、注入 CSS。

渲染：笔记里出现 ```think 代码块 → CodeblockEmbedder 解析配置 → 挂载 Dashboard。

取数：Dashboard 根据当前视图时间窗、关键字、仪表盘 path/tags 与模块的 filter/sort → 调 DataStore.queryItems() + utils/itemFilter 组合过滤。

交互：在 BlockView/TableView 勾选任务 → TaskService.completeTask() 写回文件；若是周期任务则插入下一条 → DataStore.scanFile() → notifyChange() → 视图刷新。

录入：快速录入弹窗 → InputService 依据 inputSettings 解析目标文件（必要时建文件夹/文件）→ 追加文本 → 通知刷新。









每个文件一句话（按你贴出来的清单顺序）
main.ts：插件入口与总体装配（数据、监听、样式、设置、命令、默认仪表盘）。

config/categoryColorMap.ts：类别到颜色映射与取色函数。

config/constants.ts：常量（语言标识/操作符/表情/样式 ID/默认 CSS）。

config/schema.ts：类型定义（Item/Module/Dashboard）与字段工具。

core/CodeblockEmbedder.ts：注册 ```think 代码块→渲染 Dashboard（内联或命名引用）。

core/VaultWatcher.ts：监听 md 文件增删改名→驱动 DataStore 更新。

data/mark.ts：完成任务文本改写 & 周期任务“下一条”生成（🔁 every …）。

data/parser.ts：将任务行/块区段解析成 Item（标签/日期/优先级/图标等）。

data/store.ts：扫描、索引、查询、订阅、完成任务委托（数据中心）。

services/inputService.ts：把快速录入内容写入到“主题映射”的目标文件。

services/taskService.ts：完成任务（写回、插入下一条、重扫、通知）。

ui/DashboardConfigForm.tsx：MUI 表单编辑仪表盘与模块（含过滤/排序/显示字段/分组）。

ui/InputSettingsTable.tsx：通用输入设置表格（点单元格编辑 JSON、主题增删、图标）。

ui/mui-theme.ts：统一 MUI 主题（iOS 风格）。

ui/SettingsTab.ts：设置页容器（输入设置 + 仪表盘管理）。

ui/modals/QuickBlockModal.tsx：快速录入“计划/总结/思考”。

ui/modals/QuickHabitModal.tsx：快速录入“打卡”。

ui/modals/QuickTaskModal.tsx：快速录入“任务”。

utils/date.ts：日期规范化/时间窗计算。

utils/inputSettings.ts：查插件实例拿 inputSettings。

utils/itemFilter.ts：过滤/排序/时间区间/关键字。

utils/obsidian.ts：构造 obsidian://advanced-uri 链接跳转到行。

utils/regex.ts：正则常量。

utils/templates.ts：生成任务行/块文本（与 parser 对齐）。

utils/text.ts：清洗任务标题。

utils/timing.ts：节流。

views/BlockView.tsx：任务/块混排列表视图。

views/CalendarView.tsx：日历视图占位。

views/ChartView.tsx：图表视图占位。

views/Dashboard.tsx：仪表盘顶层（切换时间窗、关键字、循环模块）。

views/ExcelView.tsx：通用表格视图。

views/index.ts：视图注册表（含占位和旧 SettingsFormView）。

views/ModulePanel.tsx：模块折叠面板（支持全局折叠/展开）。

views/SettingsFormView.tsx：旧的简易设置表单（保留兼容）。

views/styles.css：复选框样式与“完成后禁点”。

views/TableView.tsx：二维表格视图（带任务完成）。

views/TimelineView.tsx：时间轴视图占位。

views/common/TaskCheckbox.tsx：统一复选框组件。