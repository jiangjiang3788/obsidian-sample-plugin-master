下面用“文件树 + emoji”快速帮你把整个插件的结构、各文件职责 & 主线运行方式串成一张「脑内地图」。纯 txt 格式即可直接预览🔍

````
📦 think-plugin
├─ 🚀 入口 / 生命周期
│  └─ src/main.ts          – 插件启动、持久化、DataStore 初始化、样式注入、命令注册
│
├─ ⚙️ 配置 / 类型
│  ├─ config/constants.ts      – 语言标识 / 操作符 / 表情 / 样式 ID / 默认 CSS
│  ├─ config/categoryColorMap.ts – 类别 → 颜色映射
│  └─ config/schema.ts         – 核心类型 Item / Dashboard / Module，过滤排序工具
│
├─ 🧩 核心逻辑
│  ├─ core/CodeblockEmbedder.ts – 解析 ```think 代码块 → 渲染 Dashboard
│  └─ core/VaultWatcher.ts      – 监听 md 变动 → 触发 DataStore 重扫 & 视图刷新
│
├─ 🗄️ 数据层
│  ├─ data/store.ts        – 单例仓库：扫描、索引、查询、订阅、委托任务完成
│  ├─ data/parser.ts       – 将任务行 / 块解析成 Item（标签、日期、优先级…）
│  └─ data/mark.ts         – 勾选完成 & 周期任务 🔁 every… 下一条生成
│
├─ 🛠️ 业务服务
│  ├─ services/taskService.ts   – 完成任务：写回 + 生成下一条 + 重扫
│  └─ services/inputService.ts  – “快速录入”写入目标文件（按主题映射）
│
├─ 🖼️ 视图层 (Dashboard → Module → View)
│  ├─ views/Dashboard.tsx   – 时间窗 / 关键字 / path/tags 条件 → 渲染各模块
│  ├─ views/ModulePanel.tsx – 可折叠面板（Ctrl/⌘+点击全折叠/展开）
│  ├─ views/index.ts        – 视图注册表
│  ├─ views/BlockView.tsx   – 任务/块混排列表 ✔️
│  ├─ views/TableView.tsx   – 行×列二维聚合 ✔️
│  ├─ views/ExcelView.tsx   – 通用表格
│  ├─ views/CalendarView.tsx ⏳ 占位
│  ├─ views/TimelineView.tsx ⏳ 占位
│  └─ views/ChartView.tsx    ⏳ 占位
│
├─ 🛎️ 设置 / 管理 UI
│  ├─ ui/SettingsTab.ts              – 设置页容器（输入设置 + 仪表盘管理）
│  ├─ ui/InputSettingsTable.tsx      – 极简表格编辑 inputSettings
│  ├─ ui/DashboardConfigForm.tsx     – MUI 表单配置 Dashboard & Module
│  └─ ui/mui-theme.ts                – 统一 MUI 主题
│
├─ ⚡ 快速录入弹窗
│  ├─ ui/modals/QuickTaskModal.tsx   – 📅/🛫/✅ 任务
│  ├─ ui/modals/QuickBlockModal.tsx  – 📖 计划/总结/思考
│  └─ ui/modals/QuickHabitModal.tsx  – 🏆 打卡
│
├─ 🔧 工具 utils/
│  ├─ date.ts      – 年季月周天窗口 & 规范化
│  ├─ itemFilter.ts – 通用过滤/排序/关键词
│  ├─ regex.ts     – 正则库
│  ├─ templates.ts – 任务/块文本生成
│  ├─ text.ts      – 标题清洗
│  ├─ timing.ts    – throttle
│  ├─ obsidian.ts  – 构造 obsidian:// 链接
│  └─ inputSettings.ts – 获取统一输入设置
│
└─ 🎨 样式
   └─ views/styles.css – ✅ 复选框样式 & “已完成不可再点”
````

### 🔄 主线数据流一图读懂

1. **加载** 🚀：`main.ts` 初始化 → `DataStore.scanAll()` → 注册 `VaultWatcher` & `CodeblockEmbedder` → 注入 CSS & 快速录入命令
2. **渲染** 🖼️：笔记出现 \`\`\`think → CodeblockEmbedder 解析 → Dashboard 挂载
3. **取数** 📊：Dashboard 根据时间窗 / 关键字 / path/tags 调 `DataStore.queryItems` + `utils.itemFilter`
4. **交互** ✔️：在 Block/Table 视图勾选 → `taskService.completeTask` 写回 & 可能插入下一条 → `DataStore.scanFile` → notifyChange → 视图自动刷新
5. **录入** ✨：快速录入弹窗 → `inputService` 定位/创建目标文件 → 追加文本 → 同样触发刷新

这样就能快速把握各子系统职责与插件运行轨迹 ✅
