# Think OS æ’ä»¶æ¸è¿›å¼ä¼˜åŒ–è®¡åˆ’

> **æŒ‡å¯¼åŸåˆ™**ï¼šç”±ç‚¹åŠé¢ï¼Œé€æ­¥æ¨è¿›ï¼Œæ¯æ­¥å¯éªŒè¯ï¼Œä¿æŒç³»ç»Ÿç¨³å®šæ€§

---

## ğŸ¯ æ€»ä½“ç­–ç•¥

### ä¼˜åŒ–ç†å¿µ
- âœ… å°æ­¥å¿«è·‘ï¼Œå¿«é€Ÿè¿­ä»£
- âœ… å‘åå…¼å®¹ï¼Œä¸ç ´åç°æœ‰åŠŸèƒ½
- âœ… å…ˆå·¥å…·åæ¶æ„
- âœ… æµ‹è¯•å…ˆè¡Œï¼Œä¿éšœè´¨é‡
- âœ… æ–‡æ¡£åŒæ­¥ï¼ŒçŸ¥è¯†æ²‰æ·€

### æ—¶é—´è§„åˆ’
- ç¬¬ä¸€é˜¶æ®µï¼š2å‘¨ï¼ˆåŸºç¡€å»ºè®¾ï¼‰
- ç¬¬äºŒé˜¶æ®µï¼š3å‘¨ï¼ˆå±€éƒ¨ä¼˜åŒ–ï¼‰
- ç¬¬ä¸‰é˜¶æ®µï¼š4å‘¨ï¼ˆæ¨¡å—é‡æ„ï¼‰
- ç¬¬å››é˜¶æ®µï¼šæŒç»­è¿­ä»£

---

## ğŸ“… ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€å»ºè®¾ï¼ˆç¬¬1-2å‘¨ï¼‰

> **ç›®æ ‡**ï¼šå»ºç«‹å¼€å‘åŸºç¡€è®¾æ–½ï¼Œä¸ºåç»­ä¼˜åŒ–é“ºè·¯ï¼Œé›¶é£é™©æ”¹åŠ¨

### Week 1: å·¥å…·åº“å»ºè®¾

#### 1.1 åˆ›å»ºé€šç”¨å·¥å…·å‡½æ•°åº“ â­
**ä½ç½®**ï¼š`src/shared/utils/`

**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬1å¤©ï¼šæ•°ç»„æ“ä½œå·¥å…·
src/shared/utils/array.ts
- moveInArray(arr, id, direction)
- duplicateInArray(arr, id, nameField)
- reorderArray(arr, ids)
- batchUpdate(arr, ids, updater)
- batchDelete(arr, ids)

// ç¬¬2å¤©ï¼šå¯¹è±¡æ“ä½œå·¥å…·
src/shared/utils/object.ts
- deepClone(obj)
- deepMerge(target, source)
- pickFields(obj, fields)
- omitFields(obj, fields)

// ç¬¬3å¤©ï¼šå­—ç¬¦ä¸²å¤„ç†å·¥å…·
src/shared/utils/string.ts
- generateId(prefix)
- slugify(text)
- truncate(text, maxLength)
- highlightText(text, keyword)
```

**äº§å‡º**ï¼š
- âœ… 5ä¸ªå·¥å…·æ–‡ä»¶ + å®Œæ•´å•å…ƒæµ‹è¯•
- âœ… ä½¿ç”¨æ–‡æ¡£å’Œç¤ºä¾‹

**éªŒè¯æ–¹å¼**ï¼š
- å•å…ƒæµ‹è¯•100%è¦†ç›–
- ç°æœ‰åŠŸèƒ½é›¶å½±å“

---

#### 1.2 åˆ›å»ºç±»å‹å®šä¹‰ä¼˜åŒ– â­
**ä½ç½®**ï¼š`src/core/types/`

**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬4å¤©ï¼šé€šç”¨ç±»å‹å®šä¹‰
src/core/types/common.ts
- type ID = string
- type Timestamp = number
- interface Identifiable { id: ID }
- interface Timestamped { created: Timestamp; modified: Timestamp }
- interface Hierarchical { parentId: ID | null }

// ç¬¬5å¤©ï¼šä¸šåŠ¡ç±»å‹ç²¾ç‚¼
src/core/types/business.ts
- å°†schema.tsä¸­çš„æ ¸å¿ƒç±»å‹è¿ç§»
- æ·»åŠ ç±»å‹ä¿æŠ¤å‡½æ•°ï¼ˆisDataSource, isViewInstanceç­‰ï¼‰
- æ·»åŠ ç±»å‹éªŒè¯å™¨
```

**äº§å‡º**ï¼š
- âœ… ç±»å‹å®šä¹‰æ–‡ä»¶ + ç±»å‹å®ˆå«å‡½æ•°
- âœ… è¿ç§»æŒ‡å—æ–‡æ¡£

**éªŒè¯æ–¹å¼**ï¼š
- TypeScriptç¼–è¯‘é›¶é”™è¯¯
- ç°æœ‰ä»£ç é€æ­¥è¿ç§»ï¼ˆéå¼ºåˆ¶ï¼‰

---

### Week 2: å¼€å‘è§„èŒƒå’Œæµ‹è¯•åŸºç¡€

#### 2.1 å»ºç«‹ä»£ç è§„èŒƒ â­
**ä»»åŠ¡æ¸…å•**ï¼š
```bash
# ç¬¬1-2å¤©ï¼šé…ç½®å¼€å‘å·¥å…·
- æ·»åŠ ESLinté…ç½®ï¼ˆæ¸è¿›å¼è§„åˆ™ï¼‰
- æ·»åŠ Prettieré…ç½®
- é…ç½®Git hooksï¼ˆhuskyï¼‰
- æ·»åŠ ä»£ç æ³¨é‡Šè§„èŒƒ

# ç¬¬3å¤©ï¼šåˆ›å»ºå¼€å‘æ–‡æ¡£
docs/development/
â”œâ”€â”€ coding-standards.md    # ç¼–ç è§„èŒƒ
â”œâ”€â”€ git-workflow.md        # Gitå·¥ä½œæµ
â”œâ”€â”€ testing-guide.md       # æµ‹è¯•æŒ‡å—
â””â”€â”€ architecture.md        # æ¶æ„è¯´æ˜
```

**äº§å‡º**ï¼š
- âœ… å¼€å‘å·¥å…·é…ç½®æ–‡ä»¶
- âœ… å¼€å‘è§„èŒƒæ–‡æ¡£

**éªŒè¯æ–¹å¼**ï¼š
- å›¢é˜Ÿè¯„å®¡é€šè¿‡
- è¯•è¿è¡Œä¸€å‘¨æ— é˜»ç¢

---

#### 2.2 æµ‹è¯•åŸºç¡€è®¾æ–½ â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬4-5å¤©ï¼šæµ‹è¯•å·¥å…·åº“
test/helpers/
â”œâ”€â”€ fixtures.ts           // æµ‹è¯•æ•°æ®å·¥å‚
â”œâ”€â”€ mocks.ts             // Mockå¯¹è±¡
â””â”€â”€ assertions.ts        // è‡ªå®šä¹‰æ–­è¨€

// fixtures.ts ç¤ºä¾‹
export class TestDataFactory {
  static createItem(overrides?: Partial<Item>): Item
  static createDataSource(overrides?: Partial<DataSource>): DataSource
  static createViewInstance(overrides?: Partial<ViewInstance>): ViewInstance
  static createSettings(overrides?: Partial<ThinkSettings>): ThinkSettings
}
```

**äº§å‡º**ï¼š
- âœ… æµ‹è¯•è¾…åŠ©å·¥å…·åº“
- âœ… 10ä¸ªæ ¸å¿ƒåŠŸèƒ½çš„æµ‹è¯•ç”¨ä¾‹

**éªŒè¯æ–¹å¼**ï¼š
- æµ‹è¯•è¦†ç›–ç‡ä»57%æå‡åˆ°65%
- CI/CDé›†æˆæµ‹è¯•é€šè¿‡

---

## ğŸ“… ç¬¬äºŒé˜¶æ®µï¼šå±€éƒ¨ä¼˜åŒ–ï¼ˆç¬¬3-5å‘¨ï¼‰

> **ç›®æ ‡**ï¼šä¼˜åŒ–é«˜é¢‘ä½¿ç”¨çš„æ¨¡å—ï¼Œæå‡æ€§èƒ½å’Œä»£ç è´¨é‡

### Week 3: AppStoreä¼˜åŒ–ï¼ˆç¬¬ä¸€æ­¥ï¼‰

#### 3.1 æå–Settingsç®¡ç†é€»è¾‘ â­â­â­
**ä½ç½®**ï¼š`src/state/stores/SettingsStore.ts`

**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬1-2å¤©ï¼šåˆ›å»ºSettingsStore
export class SettingsStore {
  private settings: ThinkSettings;
  
  // å°†AppStoreä¸­çš„è®¾ç½®ç›¸å…³æ–¹æ³•è¿ç§»
  getSettings(): ThinkSettings
  updateSettings(updater: (draft: ThinkSettings) => void): Promise<void>
  
  // æ•°æ®æºç®¡ç†
  addDataSource(name: string, parentId?: string): Promise<void>
  updateDataSource(id: string, updates: Partial<DataSource>): Promise<void>
  deleteDataSource(id: string): Promise<void>
  
  // ... å…¶ä»–è®¾ç½®ç›¸å…³æ–¹æ³•
}

// ç¬¬3å¤©ï¼šåœ¨AppStoreä¸­ä½¿ç”¨SettingsStore
export class AppStore {
  private settingsStore: SettingsStore;
  
  // ä»£ç†æ–¹æ³•ï¼Œä¿æŒAPIå…¼å®¹
  getSettings() { return this.settingsStore.getSettings(); }
  // ... å…¶ä»–ä»£ç†æ–¹æ³•
}
```

**äº§å‡º**ï¼š
- âœ… SettingsStoreç‹¬ç«‹æ¨¡å—
- âœ… ä¿æŒAppStore APIä¸å˜ï¼ˆå…¼å®¹å±‚ï¼‰
- âœ… å•å…ƒæµ‹è¯•

**éªŒè¯æ–¹å¼**ï¼š
- æ‰€æœ‰ç°æœ‰åŠŸèƒ½æ­£å¸¸è¿è¡Œ
- æ€§èƒ½æ— é€€åŒ–
- æµ‹è¯•å…¨éƒ¨é€šè¿‡

---

#### 3.2 ä¼˜åŒ–æ‰¹é‡æ“ä½œ â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬4-5å¤©ï¼šåˆ›å»ºæ‰¹é‡æ“ä½œåŸºç±»
src/shared/patterns/BatchOperations.ts

export class BatchOperationHelper<T extends {id: string}> {
  batchUpdate(
    items: T[], 
    ids: string[], 
    updater: (item: T) => Partial<T>
  ): T[]
  
  batchDelete(items: T[], ids: string[]): T[]
  
  batchMove(items: T[], ids: string[], targetParentId: string): T[]
}

// åœ¨å„Storeä¸­å¤ç”¨
class SettingsStore {
  private batchHelper = new BatchOperationHelper<DataSource>();
  
  async batchUpdateDataSources(ids: string[], updates: Partial<DataSource>) {
    await this._updateSettingsAndPersist(draft => {
      draft.dataSources = this.batchHelper.batchUpdate(
        draft.dataSources, ids, () => updates
      );
    });
  }
}
```

**äº§å‡º**ï¼š
- âœ… æ‰¹é‡æ“ä½œå·¥å…·ç±»
- âœ… åº”ç”¨åˆ°3ä¸ªä»¥ä¸Šå®ä½“
- âœ… æ€§èƒ½æµ‹è¯•æŠ¥å‘Š

**éªŒè¯æ–¹å¼**ï¼š
- æ‰¹é‡æ“ä½œæ€§èƒ½æå‡30%+
- ä»£ç å¤ç”¨åº¦æå‡

---

### Week 4: DataStoreæ€§èƒ½ä¼˜åŒ–

#### 4.1 æ·»åŠ æŸ¥è¯¢ç´¢å¼• â­â­â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬1-3å¤©ï¼šå®ç°å¤šçº§ç´¢å¼•
src/core/services/DataStore.ts

class DataStore {
  // æ–°å¢ç´¢å¼•
  private tagIndex = new Map<string, Set<string>>();      // tag -> item IDs
  private themeIndex = new Map<string, Set<string>>();    // theme -> item IDs
  private dateIndex = new Map<string, Set<string>>();     // date -> item IDs
  private fileIndex = new Map<string, Item[]>();          // ä¿æŒç°æœ‰
  
  // ç´¢å¼•ç»´æŠ¤æ–¹æ³•
  private updateIndexes(item: Item, operation: 'add' | 'remove'): void {
    if (operation === 'add') {
      // æ›´æ–°tagç´¢å¼•
      item.tags.forEach(tag => {
        if (!this.tagIndex.has(tag)) this.tagIndex.set(tag, new Set());
        this.tagIndex.get(tag)!.add(item.id);
      });
      // æ›´æ–°themeç´¢å¼•
      if (item.theme) {
        if (!this.themeIndex.has(item.theme)) this.themeIndex.set(item.theme, new Set());
        this.themeIndex.get(item.theme)!.add(item.id);
      }
      // ... å…¶ä»–ç´¢å¼•
    } else {
      // ç§»é™¤é€»è¾‘
    }
  }
  
  // ä¼˜åŒ–æŸ¥è¯¢
  queryItems(filters: FilterRule[], sortRules: SortRule[]): Item[] {
    // 1. ä½¿ç”¨ç´¢å¼•å¿«é€Ÿè¿‡æ»¤
    let candidateIds: Set<string> | null = null;
    
    // å¦‚æœæœ‰tagè¿‡æ»¤ï¼Œä½¿ç”¨tagç´¢å¼•
    const tagFilter = filters.find(f => f.field === 'tags');
    if (tagFilter) {
      candidateIds = this.tagIndex.get(tagFilter.value) || new Set();
    }
    
    // å¦‚æœæœ‰themeè¿‡æ»¤ï¼Œä½¿ç”¨themeç´¢å¼•
    const themeFilter = filters.find(f => f.field === 'theme');
    if (themeFilter) {
      const themeSet = this.themeIndex.get(themeFilter.value) || new Set();
      candidateIds = candidateIds 
        ? new Set([...candidateIds].filter(id => themeSet.has(id)))
        : themeSet;
    }
    
    // 2. åœ¨å€™é€‰é›†ä¸­åº”ç”¨å‰©ä½™è¿‡æ»¤å™¨
    const candidates = candidateIds 
      ? this.items.filter(item => candidateIds.has(item.id))
      : this.items;
    
    // 3. åº”ç”¨è¿‡æ»¤å’Œæ’åº
    return sortItems(filterByRules(candidates, filters), sortRules);
  }
}
```

**äº§å‡º**ï¼š
- âœ… ç´¢å¼•ç³»ç»Ÿå®ç°
- âœ… æŸ¥è¯¢æ€§èƒ½åŸºå‡†æµ‹è¯•
- âœ… å¯¹æ¯”æµ‹è¯•æŠ¥å‘Š

**éªŒè¯æ–¹å¼**ï¼š
- å¤§æ•°æ®é›†(1000+ items)æŸ¥è¯¢é€Ÿåº¦æå‡3-5å€
- å†…å­˜å¢é•¿å¯æ§ï¼ˆ<10%ï¼‰

---

#### 4.2 ä¼˜åŒ–ç¼“å­˜ç­–ç•¥ â­â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬4-5å¤©ï¼šæ”¹è¿›ç¼“å­˜ç®¡ç†
src/core/services/cache/CacheManager.ts

class CacheManager {
  private saveQueue: Array<{path: string, data: any}> = [];
  private isSaving = false;
  
  // é˜Ÿåˆ—åŒ–ä¿å­˜ï¼Œé¿å…å¹¶å‘å†²çª
  async scheduleSave(path: string, data: any, priority: 'high' | 'normal' = 'normal') {
    this.saveQueue.push({path, data, priority});
    if (!this.isSaving) {
      await this.processSaveQueue();
    }
  }
  
  private async processSaveQueue() {
    this.isSaving = true;
    while (this.saveQueue.length > 0) {
      const task = this.saveQueue.shift()!;
      try {
        await this.storage.writeJSON(task.path, task.data);
      } catch (error) {
        console.error('ç¼“å­˜ä¿å­˜å¤±è´¥', error);
        // é‡è¯•é€»è¾‘
        if (task.retryCount < 3) {
          this.saveQueue.push({...task, retryCount: (task.retryCount || 0) + 1});
        }
      }
    }
    this.isSaving = false;
  }
}

// åœ¨DataStoreä¸­ä½¿ç”¨
class DataStore {
  private cacheManager = new CacheManager(this.storage);
  
  private _scheduleCacheSave() {
    this.cacheManager.scheduleSave('Think/cache.json', this.cache);
  }
}
```

**äº§å‡º**ï¼š
- âœ… å¯é çš„ç¼“å­˜ç®¡ç†å™¨
- âœ… é‡è¯•æœºåˆ¶
- âœ… æ•°æ®ä¸¢å¤±é£é™©é™ä½

**éªŒè¯æ–¹å¼**ï¼š
- å‹åŠ›æµ‹è¯•ï¼š100æ¬¡å¿«é€Ÿä¿å­˜æ— æ•°æ®ä¸¢å¤±
- å¼‚å¸¸åœºæ™¯æµ‹è¯•é€šè¿‡

---

### Week 5: UIç»„ä»¶å¤ç”¨

#### 5.1 æå–é€šç”¨è¡¨å•ç»„ä»¶ â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬1-3å¤©ï¼šåˆ›å»ºè¡¨å•ç»„ä»¶åº“
src/shared/ui/components/Form/

// FormField.tsx - é€šç”¨è¡¨å•å­—æ®µ
export const FormField = ({ 
  label, 
  type, 
  value, 
  onChange,
  error,
  ...props 
}: FormFieldProps) => {
  return (
    <div class="form-field">
      <label>{label}</label>
      {type === 'text' && <input type="text" value={value} onChange={onChange} {...props} />}
      {type === 'textarea' && <textarea value={value} onChange={onChange} {...props} />}
      {type === 'select' && <select value={value} onChange={onChange} {...props}>
        {props.options?.map(opt => <option value={opt.value}>{opt.label}</option>)}
      </select>}
      {error && <span class="error">{error}</span>}
    </div>
  );
};

// useForm.ts - è¡¨å•çŠ¶æ€ç®¡ç†Hook
export const useForm = <T extends Record<string, any>>(
  initialValues: T,
  onSubmit: (values: T) => void | Promise<void>
) => {
  const [values, setValues] = useState(initialValues);
  const [errors, setErrors] = useState<Partial<Record<keyof T, string>>>({});
  
  const handleChange = (field: keyof T) => (e: Event) => {
    const target = e.target as HTMLInputElement;
    setValues(prev => ({...prev, [field]: target.value}));
  };
  
  const handleSubmit = async (e: Event) => {
    e.preventDefault();
    await onSubmit(values);
  };
  
  return { values, errors, handleChange, handleSubmit };
};
```

**äº§å‡º**ï¼š
- âœ… 5ä¸ªé€šç”¨è¡¨å•ç»„ä»¶
- âœ… useForm Hook
- âœ… ä½¿ç”¨ç¤ºä¾‹å’Œæ–‡æ¡£

**éªŒè¯æ–¹å¼**ï¼š
- æ”¹é€ 2-3ä¸ªç°æœ‰è¡¨å•ä½¿ç”¨æ–°ç»„ä»¶
- ä»£ç å‡å°‘30%+

---

#### 5.2 åˆ›å»ºåˆ—è¡¨ç»„ä»¶åº“ â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬4-5å¤©ï¼šåˆ—è¡¨ç»„ä»¶
src/shared/ui/components/List/

// VirtualList.tsx - è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨
export const VirtualList = <T extends any>({
  items,
  itemHeight,
  renderItem,
  containerHeight = 500
}: VirtualListProps<T>) => {
  const [scrollTop, setScrollTop] = useState(0);
  
  const startIndex = Math.floor(scrollTop / itemHeight);
  const endIndex = Math.min(
    startIndex + Math.ceil(containerHeight / itemHeight) + 1,
    items.length
  );
  
  const visibleItems = items.slice(startIndex, endIndex);
  
  return (
    <div 
      class="virtual-list-container"
      style={{height: `${containerHeight}px`, overflow: 'auto'}}
      onScroll={(e) => setScrollTop((e.target as HTMLElement).scrollTop)}
    >
      <div style={{height: `${items.length * itemHeight}px`, position: 'relative'}}>
        {visibleItems.map((item, i) => (
          <div style={{
            position: 'absolute',
            top: `${(startIndex + i) * itemHeight}px`,
            width: '100%'
          }}>
            {renderItem(item, startIndex + i)}
          </div>
        ))}
      </div>
    </div>
  );
};
```

**äº§å‡º**ï¼š
- âœ… VirtualListç»„ä»¶
- âœ… DraggableListç»„ä»¶
- âœ… æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹

**éªŒè¯æ–¹å¼**ï¼š
- å¤§åˆ—è¡¨(1000+ items)æ¸²æŸ“æ€§èƒ½æå‡5å€+
- å†…å­˜å ç”¨å‡å°‘50%

---

## ğŸ“… ç¬¬ä¸‰é˜¶æ®µï¼šæ¨¡å—é‡æ„ï¼ˆç¬¬6-9å‘¨ï¼‰

> **ç›®æ ‡**ï¼šæ¶æ„å±‚é¢ä¼˜åŒ–ï¼ŒåŸºäºå‰æœŸç»éªŒè¿›è¡Œæ¨¡å—åŒ–é‡æ„

### Week 6-7: Storeåˆ†ç¦»é‡æ„

#### 6.1 å®ŒæˆStoreå®Œå…¨æ‹†åˆ† â­â­â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬1-4å¤©ï¼šåˆ›å»ºä¸“èŒStore
src/state/stores/
â”œâ”€â”€ AppStore.ts           // ä¸»Storeï¼Œåè°ƒå…¶ä»–Store
â”œâ”€â”€ SettingsStore.ts      // è®¾ç½®ç®¡ç†ï¼ˆå·²å®Œæˆï¼‰
â”œâ”€â”€ TimerStore.ts         // è®¡æ—¶å™¨çŠ¶æ€
â”œâ”€â”€ LayoutStore.ts        // å¸ƒå±€å’Œè§†å›¾
â”œâ”€â”€ ThemeStore.ts         // ä¸»é¢˜ç®¡ç†
â””â”€â”€ GroupStore.ts         // åˆ†ç»„ç®¡ç†

// TimerStore.ts ç¤ºä¾‹
export class TimerStore {
  private timers: TimerState[] = [];
  private listeners = new Set<() => void>();
  
  async addTimer(timer: Omit<TimerState, 'id'>): Promise<TimerState>
  async updateTimer(id: string, updates: Partial<TimerState>): Promise<void>
  async removeTimer(id: string): Promise<void>
  getActiveTimer(): TimerState | undefined
  
  subscribe(listener: () => void): () => void
}

// ç¬¬5-7å¤©ï¼šé‡æ„AppStoreä¸ºç»„åˆæ¨¡å¼
export class AppStore {
  readonly settings: SettingsStore;
  readonly timer: TimerStore;
  readonly layout: LayoutStore;
  readonly theme: ThemeStore;
  readonly group: GroupStore;
  
  constructor() {
    this.settings = container.resolve(SettingsStore);
    this.timer = container.resolve(TimerStore);
    // ...
  }
  
  // æä¾›ç»Ÿä¸€è®¢é˜…æ¥å£
  subscribe(listener: () => void): () => void {
    const unsubscribes = [
      this.settings.subscribe(listener),
      this.timer.subscribe(listener),
      // ...
    ];
    return () => unsubscribes.forEach(fn => fn());
  }
}
```

**äº§å‡º**ï¼š
- âœ… 5ä¸ªç‹¬ç«‹Storeæ¨¡å—
- âœ… é‡æ„AppStoreä¸ºç»„åˆå®¹å™¨
- âœ… å‘åå…¼å®¹å±‚ï¼ˆé€æ­¥åºŸå¼ƒæ—§APIï¼‰
- âœ… è¿ç§»æ–‡æ¡£

**éªŒè¯æ–¹å¼**ï¼š
- æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
- æ¯ä¸ªStoreç‹¬ç«‹å¯æµ‹è¯•
- ä»£ç è¡Œæ•°å‡å°‘20%+

**é£é™©æ§åˆ¶**ï¼š
- åˆ†æ­¥éª¤è¿ç§»ï¼Œæ¯ä¸ªStoreç‹¬ç«‹å®Œæˆå’Œæµ‹è¯•
- ä¿ç•™å…¼å®¹API 1ä¸ªç‰ˆæœ¬
- è¯¦ç»†çš„è¿ç§»æ—¥å¿—

---

#### 6.2 åˆ›å»ºCRUDåŸºç±» â­â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬8-10å¤©ï¼šæŠ½è±¡CRUDæ¨¡å¼
src/shared/patterns/CRUDStore.ts

export abstract class CRUDStore<T extends {id: string}> {
  protected items: T[] = [];
  
  protected abstract getStorageKey(): string;
  protected abstract validateItem(item: T): boolean;
  
  async add(item: Omit<T, 'id'>): Promise<T> {
    const newItem = {
      ...item,
      id: generateId(this.getIdPrefix())
    } as T;
    
    if (!this.validateItem(newItem)) {
      throw new Error('Invalid item');
    }
    
    this.items.push(newItem);
    await this.persist();
    this.notifyListeners();
    return newItem;
  }
  
  async update(id: string, updates: Partial<T>): Promise<void> {
    const index = this.items.findIndex(item => item.id === id);
    if (index === -1) throw new Error('Item not found');
    
    this.items[index] = {...this.items[index], ...updates};
    await this.persist();
    this.notifyListeners();
  }
  
  async delete(id: string): Promise<void> {
    this.items = this.items.filter(item => item.id !== id);
    await this.persist();
    this.notifyListeners();
  }
  
  // æ‰¹é‡æ“ä½œ
  async batchUpdate(ids: string[], updater: (item: T) => Partial<T>): Promise<void>
  async batchDelete(ids: string[]): Promise<void>
  
  protected abstract getIdPrefix(): string;
  protected abstract persist(): Promise<void>;
  protected abstract notifyListeners(): void;
}

// å…·ä½“å®ç°ç¤ºä¾‹
export class DataSourceStore extends CRUDStore<DataSource> {
  protected getStorageKey() { return 'dataSources'; }
  protected getIdPrefix() { return 'ds'; }
  protected validateItem(item: DataSource) {
    return !!item.name && Array.isArray(item.filters);
  }
  
  // åªéœ€å®ç°ç‰¹å®šä¸šåŠ¡é€»è¾‘
  async addFilter(dataSourceId: string, filter: FilterRule): Promise<void> {
    await this.update(dataSourceId, draft => {
      draft.filters.push(filter);
    });
  }
}
```

**äº§å‡º**ï¼š
- âœ… CRUDStoreæŠ½è±¡åŸºç±»
- âœ… 3ä¸ªå®ä½“è¿ç§»åˆ°æ–°æ¨¡å¼
- âœ… ä»£ç å¤ç”¨ç‡æå‡60%

**éªŒè¯æ–¹å¼**ï¼š
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡80%+
- æ‰€æœ‰CRUDæ“ä½œåŠŸèƒ½æ­£å¸¸

---

### Week 8: æŸ¥è¯¢å¼•æ“ä¼˜åŒ–

#### 8.1 å®ç°æŸ¥è¯¢æ„å»ºå™¨ â­â­â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬1-5å¤©ï¼šæŸ¥è¯¢ç³»ç»Ÿé‡æ„
src/core/query/

// QueryBuilder.ts
export class QueryBuilder {
  private conditions: Condition[] = [];
  
  where(field: string, op: Operator, value: any): this {
    this.conditions.push({field, op, value, type: 'and'});
    return this;
  }
  
  orWhere(field: string, op: Operator, value: any): this {
    this.conditions.push({field, op, value, type: 'or'});
    return this;
  }
  
  orderBy(field: string, direction: 'asc' | 'desc' = 'asc'): this {
    this.sortRules.push({field, dir: direction});
    return this;
  }
  
  build(): Query {
    return {
      conditions: this.conditions,
      sortRules: this.sortRules
    };
  }
  
  // æŸ¥è¯¢ä¼˜åŒ–
  optimize(): Query {
    // 1. åˆå¹¶ç›¸åŒå­—æ®µæ¡ä»¶
    // 2. æå–ç´¢å¼•å­—æ®µåˆ°æœ€å‰
    // 3. ç§»é™¤å†—ä½™æ¡ä»¶
    return optimizedQuery;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const query = new QueryBuilder()
  .where('theme', 'includes', 'å·¥ä½œ')
  .where('date', '>', '2024-01-01')
  .orderBy('date', 'desc')
  .build();

const items = dataStore.query(query);
```

**äº§å‡º**ï¼š
- âœ… æŸ¥è¯¢æ„å»ºå™¨
- âœ… æŸ¥è¯¢ä¼˜åŒ–å™¨
- âœ… æ‰§è¡Œè®¡åˆ’åˆ†æå·¥å…·

**éªŒè¯æ–¹å¼**ï¼š
- å¤æ‚æŸ¥è¯¢æ„å»ºæ›´ç®€å•
- æŸ¥è¯¢æ€§èƒ½æå‡20%+

---

### Week 9: é”™è¯¯å¤„ç†å’Œç¨³å®šæ€§

#### 9.1 ç»Ÿä¸€é”™è¯¯å¤„ç† â­â­â­â­
**ä»»åŠ¡æ¸…å•**ï¼š
```typescript
// ç¬¬1-3å¤©ï¼šé”™è¯¯åˆ†ç±»å’Œå¤„ç†
src/shared/errors/

// ErrorTypes.ts
export class BusinessError extends Error {
  constructor(message: string, public code: string) {
    super(message);
  }
}

export class ValidationError extends BusinessError {
  constructor(field: string, message: string) {
    super(`${field}: ${message}`, 'VALIDATION_ERROR');
  }
}

export class NotFoundError extends BusinessError {
  constructor(resource: string, id: string) {
    super(`${resource} not found: ${id}`, 'NOT_FOUND');
  }
}

// ErrorHandler.ts
export class ErrorHandler {
  handle(error: Error): UserFeedback {
    if (error instanceof ValidationError) {
      return {
        type: 'warning',
        message: error.message,
        duration: 3000
      };
    }
    
    if (error instanceof NotFoundError) {
      return {
        type: 'error',
        message: error.message,
        duration: 5000
      };
    }
    
    // æœªçŸ¥é”™è¯¯
    console.error('Unexpected error:', error);
    return {
      type: 'error',
      message: 'æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•',
      duration: 5000
    };
  }
}

// ç¬¬4-5å¤©ï¼šå…¨å±€é”™è¯¯è¾¹ç•Œ
src/shared/ui/components/ErrorBoundary.tsx

export class ErrorBoundary extends Component {
  state = { error: null };
  
  componentDidCatch(error: Error) {
    this.setState({ error });
    errorHandler.handle(error);
  }
  
  render() {
    if (this.state.error) {
      return <ErrorView error={this.state.error} />;
    }
    return this.props.children;
  }
}
```

**äº§å‡º**ï¼š
- âœ… é”™è¯¯ç±»å‹ä½“ç³»
- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†å™¨
- âœ… é”™è¯¯è¾¹ç•Œç»„ä»¶
- âœ… é”™è¯¯æ—¥å¿—æ”¶é›†

**éªŒè¯æ–¹å¼**ï¼š
- æ‰€æœ‰å¼‚å¸¸éƒ½è¢«æ­£ç¡®æ•è·å’Œæ˜¾ç¤º
- ç”¨æˆ·ä½“éªŒå‹å¥½
- é”™è¯¯å¯è¿½è¸ª

---

## ğŸ“… ç¬¬å››é˜¶æ®µï¼šæŒç»­ä¼˜åŒ–ï¼ˆç¬¬10å‘¨+ï¼‰

> **ç›®æ ‡**ï¼šåŸºäºå‰æœŸé‡æ„ï¼ŒæŒç»­è¿­ä»£å’Œä¼˜åŒ–

### 10.1 æ€§èƒ½ç›‘æ§å’Œåˆ†æ â­â­â­
**ä»»åŠ¡**ï¼š
- é›†æˆæ€§èƒ½ç›‘æ§å·¥å…·
- å»ºç«‹æ€§èƒ½åŸºå‡†
- å®šæœŸæ€§èƒ½å›å½’æµ‹è¯•

### 10.2 æ–‡æ¡£å®Œå–„ â­â­
**ä»»åŠ¡**ï¼š
- APIæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ
- å¼€å‘è€…æŒ‡å—æ›´æ–°
- æœ€ä½³å®è·µæ–‡æ¡£

### 10.3 è‡ªåŠ¨åŒ–æµ‹è¯•å¢å¼º â­â­â­
**ä»»åŠ¡**ï¼š
- E2Eæµ‹è¯•è¦†ç›–å…³é”®æµç¨‹
- æ€§èƒ½æµ‹è¯•è‡ªåŠ¨åŒ–
- è§†è§‰å›å½’æµ‹è¯•

### 10.4 ç”¨æˆ·ä½“éªŒä¼˜åŒ– â­â­
**ä»»åŠ¡**ï¼š
- åŠ è½½çŠ¶æ€ä¼˜åŒ–
- é”™è¯¯æç¤ºä¼˜åŒ–
- å¿«æ·é”®ç³»ç»Ÿ
- å›½é™…åŒ–æ”¯æŒå‡†å¤‡

---

## ğŸ“Š è¿›åº¦è¿½è¸ª

### æ¯å‘¨æ£€æŸ¥ç‚¹
- **å‘¨ä¸€**ï¼šæœ¬å‘¨è®¡åˆ’ç¡®è®¤ï¼Œä»»åŠ¡åˆ†è§£
- **å‘¨ä¸‰**ï¼šä¸­æœŸæ£€æŸ¥ï¼Œé£é™©è¯†åˆ«
- **å‘¨äº”**ï¼šæœ¬å‘¨æ€»ç»“ï¼Œé—®é¢˜å¤ç›˜

### è´¨é‡é—¨ç¦
æ¯ä¸ªé˜¶æ®µå®Œæˆå¿…é¡»æ»¡è¶³ï¼š
- âœ… å•å…ƒæµ‹è¯•é€šè¿‡ç‡ 100%
- âœ… é›†æˆæµ‹è¯•é€šè¿‡
- âœ… ä»£ç å®¡æŸ¥å®Œæˆ
- âœ… æ–‡æ¡£åŒæ­¥æ›´æ–°
- âœ… æ€§èƒ½åŸºå‡†è¾¾æ ‡

### å›æ»šç­–ç•¥
- ä¿æŒGitåˆ†æ”¯æ¸…æ™°
- æ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹åˆ†æ”¯
- åˆå¹¶å‰å……åˆ†æµ‹è¯•
- å‡ºç°é—®é¢˜ç«‹å³å›æ»š

---

## ğŸ¯ é¢„æœŸæ”¶