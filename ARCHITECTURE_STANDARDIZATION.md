# é¡¹ç›®æ¶æ„æ ‡å‡†åŒ–å®æ–½æŠ¥å‘Š

## ğŸ¯ å®æ–½ç›®æ ‡

æ ¹æ®é¡¹ç›®æ¶æ„é‡æ„è§„èŒƒï¼Œå¯¹ä»£ç åº“è¿›è¡Œæ ‡å‡†åŒ–ï¼Œç¡®ä¿ä¸¥æ ¼éµå¾ªä»¥ä¸‹ä¾èµ–çº¦æŸï¼š

```text
âœ… features/* â†’ coreï¼ˆæ¥å£ï¼‰ + sharedï¼ˆutils/types/uiï¼‰
âœ… core       â†’ sharedï¼ˆutils/typesï¼‰  
âœ… shared     â†’ æ— ä¸šåŠ¡ä¾èµ–

âŒ shared â†’ core          
âŒ shared â†’ features      
âŒ core   â†’ features      
âŒ features A â†’ features B 
âŒ UI â†’ core çš„å…·ä½“å®ç°    
âŒ UI â†’ å…¶ä»– feature çš„é€»è¾‘
```

## ğŸ”§ å·²å®Œæˆçš„é‡æ„å·¥ä½œ

### é˜¶æ®µä¸€ï¼šä¾èµ–å…³ç³»æ¸…ç† âœ…

**1.1 ä¿®å¤ Features é—´è¿è§„ä¾èµ–**
- **é—®é¢˜**ï¼š`StatisticsView.tsx` ç›´æ¥ä¾èµ– `@features/settings/StatisticsViewEditor` 
- **è§£å†³**ï¼š
  - åˆ›å»º `src/core/config/viewConfigs.ts` å­˜æ”¾å…±äº«é…ç½®
  - å°† `DEFAULT_CONFIG` ç§»è‡³ core å±‚ä½œä¸º `STATISTICS_VIEW_DEFAULT_CONFIG`
  - æ›´æ–°ä¸¤ä¸ªæ–‡ä»¶çš„å¯¼å…¥è·¯å¾„ä½¿ç”¨å…±äº«é…ç½®

**1.2 å»ºç«‹ä¸¥æ ¼çš„å¯¼å…¥è¾¹ç•Œ**
- åˆ›å»º `.eslintrc-architecture.js` ESLint è§„åˆ™æ–‡ä»¶
- é…ç½®è‡ªåŠ¨æ£€æµ‹è¿è§„å¯¼å…¥çš„è§„åˆ™
- é’ˆå¯¹ä¸åŒç›®å½•å±‚çº§è®¾ç½®ç‰¹å®šçº¦æŸ

### é˜¶æ®µäºŒï¼šCore ç›®å½•æ ‡å‡†åŒ– âœ…

**2.1 ä¸šåŠ¡æ¦‚å¿µæŠ½è±¡åŒ–**
- **é‡å‘½å**ï¼š`TaskService.ts` â†’ `ItemService.ts`
- **æŠ½è±¡åŒ–æ–¹æ³•å**ï¼š
  - `getTaskLine()` â†’ `getItemLine()`
  - `updateTaskLine()` â†’ `updateItemLine()` 
  - `completeTask()` â†’ `completeItem()`
  - `updateTaskTime()` â†’ `updateItemTime()`
  - `parseTaskId()` â†’ `parseItemId()`
- **æ›´æ–°æ³¨é‡Š**ï¼šç§»é™¤æ‰€æœ‰å…·ä½“ä¸šåŠ¡æœ¯è¯­ï¼Œä½¿ç”¨æŠ½è±¡æ¦‚å¿µ

**2.2 éªŒè¯ Core å†…å®¹è§„èŒƒ**
- âœ… ç¡®è®¤æ— è¿è§„ä¸šåŠ¡è¯æ±‡ï¼štask, view, timer, settings ç­‰
- âœ… ä¿æŒå¹³å°æ— å…³çš„æŠ½è±¡æ¥å£è®¾è®¡
- âœ… ç»´æŠ¤é¢†åŸŸæ— å…³çš„é€šç”¨é€»è¾‘

### é˜¶æ®µä¸‰ï¼šShared ç›®å½•éªŒè¯ âœ…

**3.1 ç¡®è®¤çº¯é€šç”¨å±‚çŠ¶æ€**
- âœ… éªŒè¯æ— ä¸šåŠ¡ç‰¹å®šç»„ä»¶ï¼ˆTaskCheckboxã€TaskSendToTimerButton ç­‰ï¼‰
- âœ… ç¡®è®¤åªåŒ…å«çº¯é€šç”¨ UI ç»„ä»¶ï¼ˆButtonã€Modalã€Inputï¼‰
- âœ… éªŒè¯æ— ä¸šåŠ¡é€»è¾‘æ³„éœ²

### é˜¶æ®µå››ï¼šæ„å»ºæ—¶éªŒè¯ç³»ç»Ÿ âœ…

**4.1 è‡ªåŠ¨åŒ–æ£€æŸ¥å·¥å…·**
- åˆ›å»º `scripts/validate-architecture.js` æ¶æ„éªŒè¯è„šæœ¬
- å®ç°ä»¥ä¸‹æ£€æŸ¥é¡¹ï¼š
  - Features é—´ç›¸äº’ä¾èµ–æ£€æµ‹
  - Core å±‚ä¸šåŠ¡è¯æ±‡æ£€æµ‹  
  - Shared å±‚ä¸šåŠ¡ç»„ä»¶æ£€æµ‹
  - è¿è§„å¯¼å…¥å…³ç³»æ£€æµ‹

**4.2 ESLint é›†æˆ**
- é…ç½® TypeScript ESLint è§„åˆ™
- æŒ‰ç›®å½•å±‚çº§è®¾ç½®ä¸“ç”¨çº¦æŸè§„åˆ™
- æä¾›æ¸…æ™°çš„è¿è§„æç¤ºä¿¡æ¯

## ğŸ“Š éªŒè¯ç»“æœ

```bash
$ node scripts/validate-architecture.js
ğŸ—ï¸  å¼€å§‹æ¶æ„ä¾èµ–å…³ç³»éªŒè¯...

ğŸ“Š éªŒè¯å®Œæˆï¼
âœ… æ­å–œï¼æ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–çº¦æŸè¿è§„
ğŸ‰ é¡¹ç›®æ¶æ„ç¬¦åˆæ ‡å‡†åŒ–è§„èŒƒ
```

## ğŸ—‚ï¸ æ–°å¢/ä¿®æ”¹çš„æ–‡ä»¶

### æ–°å¢æ–‡ä»¶
- `src/core/config/index.ts` - Core é…ç½®å¯¼å‡º
- `src/core/config/viewConfigs.ts` - è§†å›¾é…ç½®å…±äº«æ–‡ä»¶  
- `.eslintrc-architecture.js` - æ¶æ„çº¦æŸ ESLint è§„åˆ™
- `scripts/validate-architecture.js` - æ¶æ„éªŒè¯è„šæœ¬
- `ARCHITECTURE_STANDARDIZATION.md` - æœ¬æ–‡æ¡£

### é‡æ„æ–‡ä»¶
- `src/core/services/TaskService.ts` â†’ `src/core/services/ItemService.ts` (é‡å‘½å+æŠ½è±¡åŒ–)
- `src/features/views/StatisticsView.tsx` (ä¿®å¤è¿è§„å¯¼å…¥)
- `src/features/settings/ui/components/view-editors/StatisticsViewEditor.tsx` (ä½¿ç”¨å…±äº«é…ç½®)

## ğŸ¯ æ ‡å‡†åŒ–æˆæœ

1. **é›¶ä¾èµ–çº¦æŸè¿è§„** - æ‰€æœ‰ä¾èµ–å…³ç³»å®Œå…¨ç¬¦åˆæ¶æ„è§„èŒƒ
2. **æŠ½è±¡åŒ– Core å±‚** - ç§»é™¤å…·ä½“ä¸šåŠ¡æ¦‚å¿µï¼Œæé«˜å¯ç»´æŠ¤æ€§
3. **çº¯å‡€ Shared å±‚** - ç¡®ä¿é€šç”¨ç»„ä»¶åº“çš„ç‹¬ç«‹æ€§
4. **è‡ªåŠ¨åŒ–éªŒè¯** - å»ºç«‹æŒç»­ç›‘æ§æœºåˆ¶é˜²æ­¢å›é€€

## ğŸš€ åç»­å»ºè®®

### å¼€å‘æµç¨‹æ•´åˆ
```bash
# package.json scripts å»ºè®®æ·»åŠ 
{
  "scripts": {
    "lint:architecture": "node scripts/validate-architecture.js",
    "lint": "eslint . --config .eslintrc-architecture.js && npm run lint:architecture"
  }
}
```

### CI/CD é›†æˆ
åœ¨æ„å»ºæµç¨‹ä¸­æ·»åŠ æ¶æ„éªŒè¯æ­¥éª¤ï¼Œç¡®ä¿æ¯æ¬¡æäº¤éƒ½ç¬¦åˆè§„èŒƒã€‚

### å›¢é˜ŸåŸ¹è®­
å¯¹å›¢é˜Ÿæˆå‘˜è¿›è¡Œæ¶æ„çº¦æŸè§„èŒƒåŸ¹è®­ï¼Œç¡®ä¿æ–°ä»£ç éµå¾ªå·²å»ºç«‹çš„ä¾èµ–å…³ç³»ã€‚

## âœ… éªŒæ”¶æ ‡å‡†

- [x] æ¶ˆé™¤æ‰€æœ‰ Features é—´çš„ç›´æ¥ä¾èµ–
- [x] Core å±‚å®Œå…¨ç§»é™¤ä¸šåŠ¡ç‰¹å®šæœ¯è¯­
- [x] Shared å±‚ä¿æŒçº¯é€šç”¨çŠ¶æ€
- [x] å»ºç«‹è‡ªåŠ¨åŒ–éªŒè¯æœºåˆ¶
- [x] é€šè¿‡æ¶æ„éªŒè¯è„šæœ¬æ£€æŸ¥
- [x] ESLint è§„åˆ™é…ç½®å®Œæˆ

**ğŸ‰ é¡¹ç›®æ¶æ„æ ‡å‡†åŒ–å®æ–½å®Œæˆï¼**
